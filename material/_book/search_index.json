[["index.html", "Análisis Estadístico: Muestreo Capítulo 1 Muestreo 1.1 ¿Qué es y para qué sirve muestreo? 1.2 Ventajas e importancia de utilizar muestreo en el mundo corporativo 1.3 ¿Qué se requiere para formular un problema de muestreo? 1.4 Tipos de muestreo 1.5 Diferentes formas de hacer muestreo 1.6 Tamaño de muestra", " Análisis Estadístico: Muestreo Oscar Arturo Bringas López Capítulo 1 Muestreo 1.1 ¿Qué es y para qué sirve muestreo? El muestreo es el proceso de seleccionar un conjunto de individuos de una población con el fin de estudiarlos y poder caracterizar el total de la población. Nos ayuda a obtener información fiable de la población a partir de una muestra de la que extrae inferencias estadísticas con un margen de error medido en términos de probabilidades. En otras palabras, en una investigación por muestreo podremos estudiar el comportamiento y las opiniones de toda una población analizando únicamente una parte de esta, teniendo en cuenta que siempre existirá un margen de error a la hora de realizar dichos cálculos. El aumento del uso de las técnicas de muestreo en la investigación es claro porque es un procedimiento que cuesta mucho menos dinero, consume menos tiempo y puede incluso ser más preciso que al realizar una enumeración completa, también llamada censo. Una muestra bien seleccionada de unos cuantos miles de individuos puede representar con gran precisión una población de millones. 1.2 Ventajas e importancia de utilizar muestreo en el mundo corporativo Ventajas Reducción de costos: Los costos de un estudio serán menores si los datos de interés se pueden obtener a partir de una muestra de la población. Por ejemplo, cuando se realizan estudios de prevalencia de un evento de interés, es más económico medir una muestra representativa de 1500 sujetos de una población, que el total de individuos que la componen. Eficiencia: Al trabajar con un número reducido de sujetos de estudio, representativos de la población; el tiempo necesario para conducir el estudio y obtener resultados y conclusiones será notoriamente menor. Importancia No es posible ponerse en contacto con todos los clientes, por lo que solo se incluye una muestra o un subconjunto de esa población al realizar una investigación estadística. El supuesto es que la muestra es representativa de toda la población. Las empresas utilizan el muestreo para determinar nuevos nichos de mercado, productos y niveles de satisfacción. Investigación de mercado Ampliar la base de clientes puede significar encontrar nuevos nichos de mercado. El muestreo de la población de ese nicho le permite a la empresa saber si esta es una perspectiva que debe perseguirse o si debe dejarse en un segundo plano. Desarrollo de un producto nuevo Una filosofía de desarrollo de productos es inventar un nuevo producto y luego encontrar un mercado para él. La otra filosofía es escuchar al mercado y desarrollar un producto que resuelva sus problemas o satisfaga sus necesidades. Ambas filosofías se benefician del muestreo del mercado: los clientes potenciales. Por ejemplo: un cliente que, en los últimos años, ha contratado tres promociones de teléfonos móvil provistas por cierta compañía, es un cliente potencial de esta empresa a la hora de una nueva promoción. Satisfacción del cliente Lo más probable es que una empresa muy pequeña pregunte a todos sus clientes sobre su nivel de satisfacción. Sin embargo, eso no es posible con una empresa que tiene varios cientos de clientes. Las empresas de servicios pueden utilizar el muestreo sobre los clientes para analizar como responden los clientes a los servicios o productos accesibles en el mercado. Algunos indicadores de satisfacción son los siguientes: NPS (Net Promoter Score): mide el nivel de lealtad y la probabilidad de que el cliente muestre tu marca a otros. CES (Customer Effort Score): mide cuánto esfuerzo necesita el cliente para utilizar los productos/servicios de tu empresa. CSAT (Customer Satisfaction Score): métrica utilizada específicamente para calcular la satisfacción del cliente con un proceso, producto o servicio en particular. SPS (Service Partner Satisfaction): indica, cuantitativamente, el grado de satisfacción del cliente. FCR (First Contact Resolution): mide cuántas solicitudes se resolvieron en un solo contacto. FRT (First Response Time): mide el tiempo que tarda el cliente en recibir una primera respuesta de tu empresa 1.3 ¿Qué se requiere para formular un problema de muestreo? Es requisito fundamental de una buena muestra que las características de interés que existen en la población se reflejen en la muestra de la manera más cercana posible. Esas características tienen que ver principalmente con el tamaño de la muestra y con la manera de obtenerla. Para esto se necesitan definir los siguientes conceptos: Población objetivo: Colección completa de todas las unidades que se quieren estudiar. Muestra: Subconjunto de la población. Unidad de muestreo: Objeto a ser seleccionado en la muestra que permitirá el acceso a la unidad de observación. Unidad de observación: Objeto sobre el que finalmente se realiza la medición. Variable de interés: Característica propia de los individuos sobre la que se realiza la inferencia para resolver los objetivos de la investigación. En la teoría de muestreo la variable de interés no se supone como una variable aleatoria sino como una cantidad fija o una característica propia de las unidades que componen la población. 1.4 Tipos de muestreo Una muestra puede ser obtenida de dos tipos: probabilística y no probabilística. 1.4.1 Muestreo no probabilístico Utiliza métodos en que no interviene el azar, por lo que se desconoce la probabilidad asociada a cada individuo para formar parte de la muestra. Normalmente estos métodos se utilizan en estudios exploratorios o intencionales, en los cuales no es necesario proyectar los resultados. El inconveniente de este método es que no puede asegurarse la representatividad de la muestra. Los sistemas de muestreo no probabilísticos de clasifican de la siguiente manera: Muestreo por cuotas o cupos: Si se conocen las características de la población a estudiar, se elegirán los individuos respetando siempre ciertas cuotas por edad, género, zona de residencia, entre otras que habrán sido prefijadas. Primero se realiza una clara división por cuotas (estratos) y posteriormente a cada cuota se aplica un muestreo discrecional. Ejemplo: Seleccionar 20 estudiantes de la carrera de ingeniería industrial, que ya hayan cursado el noveno semestre de la carrera y que tengan promedio arriba del 6.5. Se eligen a los primeros 20 que cumplan con estas condiciones. Este tipo de muestreo se utiliza especialmente en las encuestas de opinión. Muestreo por conveniencia: Las muestras de la población se seleccionan solo porque están convenientemente disponibles para el investigador. Es la técnica de muestreo no probabilística más común, debido a su velocidad, costo-efectividad y facilidad de disponibilidad de la muestra. Ejemplo: Utilizar a estudiantes voluntarios que sean conocidos del investigador. El investigador puede enviar la encuesta a los estudiantes y ellos en este caso actuarían como muestra. Muestreo bola de nieve: Se basa en referencias de sujetos iniciales para generar sujetos adicionales, de ahí deriva su nombre. Cuando se aplica este método de muestreo, los miembros del grupo de muestra se reclutan a través de una remisión en cadena. Estos pasos se repiten hasta que se encuentra el tamaño de muestra necesario. Éticamente, no se debe pedir a los participantes del estudio que identifiquen a otros participantes potenciales. Más bien, se les debe pedir que alienten a otros a que participen. Este muestreo consiste en dos partes: Identificar sujetos potenciales en la población. A menudo, sólo uno o dos sujetos pueden ser encontrados inicialmente. Pedir a esos sujetos que recluten a otras personas. Los participantes deben ser conscientes de que no tienen que proporcionar ningún otro nombre. Ejemplo: Realizar estudios con poblaciones marginales, tipos de enfermos, especialistas, etc. Muestreo discrecional: La muestra es elegida a partir de un criterio profesional y puede basarse en la experiencia de investigaciones realizadas con anterioridad o en el conocimiento que el investigador tiene sobre la población. Es difícil estimar cuán cerca de la realidad se encuentra esta estimación. De hecho, la relevancia de los resultados depende de la experiencia del investigador. Ejemplo: se desea realizar una investigación sobre el comportamiento de los padres con sus hijos. Por lo tanto, el investigador selecciona como muestra a personas que tengan hijos, ya que las considera aptas de conocimiento para formar parte de la investigación. 1.4.2 Muestreo probabilístico El muestreo probabilístico se define como aquel en que todos los individuos de la población tienen una probabilidad de entrar a formar parte de la muestra. Los diseños en que interviene el azar producen muestras representativas la mayoría de las veces, aunque no garantizan la representatividad de la población que sometemos a estudio. Los sistemas de muestreo probabilísticos de clasifican de la siguiente manera: Muestreo aleatorio simple: Se caracteriza porque cada elemento de la población tiene la misma probabilidad de ser escogido para formar parte de la muestra. Una vez censado el marco de la población, se asigna un número a cada individuo o elemento y se elige aleatoriamente Para seleccionar una muestra de este tipo se requiere tener en forma de lista todos los elementos que integran la población investigada y utilizar tablas de números aleatorios. Ejemplo: A un grupo de 100 personas se les numera de uno a cien y se depositan en una urna 100 canicas a su vez numeradas de uno a cien. Para obtener una muestra aleatoria simple de 20 elementos, tendríamos que sacar 20 canicas numeradas de la urna que nos seleccionarán en forma completamente aleatoria a los 20 elementos escogidos para que opinen sobre un nuevo producto. Muestreo sistemático: Es susceptible de ser más preciso que el muestreo aleatorio simple. Se elige un primer elemento del universo y luego se van escogiendo otros elementos igualmente espaciados a partir del primero. Consiste en dividir la población en \\(n\\) estratos, compuestos de \\(k\\) unidades. Ejemplo: a partir de una lista de 100 establecimientos de comestibles, deseamos seleccionar una muestra probabilística de 25 tiendas. La forma de hacerlo sería: Dividir 100 entre 25 para obtener 4 tiendas que es el salto sistemático. Extraer un número al azar entre 1 y 4. Supóngase que es el número 3 el cual corresponde al primer elemento seleccionado. Se incluyen en la muestra de establecimientos numerados: \\(3, 7, 11, 15\\) Muestreo estratificado: En este tipo de muestreo la población de estudio se divide en subgrupos o estratos, escogiendo posteriormente una muestra al azar de cada estrato. Esta división suele realizarse según una característica que pueda influir sobre los resultados del estudio. Si la estratificación se realiza respecto una característica se denomina muestreo estratificado simple, y si se realiza respecto a dos o más características sedenomina muestreo estratificado compuesto. Ejemplo: Si existen 5 millones de hipertensos en una población y hay un \\(35\\%\\) de pacientes que fuman, podemos estratificar de manera que en nuestra muestra queden representados al igual que en el total de la población, la misma proporción de hipertensos fumadores (\\(35\\%\\)) y de no fumadores (\\(65\\%\\)). Muestreo por conglomerados: El muestreo por conglomerados nos ayuda cuando es imposible o poco práctico crear un marco de muestreo de una población objetivo debido a que está muy dispersa geográficamente y el costo de la recopilación de datos es relativamente alto. Los elementos de la población son seleccionados al azar en forma natural por agrupaciones (clusters). Los elementos del muestreo se seleccionan de la población de manera individual, uno a la vez. La heterogeneidad del grupo es fundamental para un buen diseño del muestreo por conglomerados. Por otra parte, los elementos dentro de cada grupo debe ser tan heterogéneos como la población objetivo Ejemplo: Una ONG quiere crear una muestra de niñas en 5 ciudades vecinas para obtener información sobre su nivel de educación. Muestreo poli-etápico: Consiste en empezar a muestrear por algo que no constituye el objeto de la investigación (unidades primarias), y obtener una muestra dentro de cada una de ellas (unidades secundarias). Pueden utilizarse sucesivamente tantas etapas como sean necesarias, y en cada una de ellas, una técnica de muestreo diferente. Este método de muestreo se utiliza cuando la población de referencia es muy amplia y dispersa, ya que facilita la realización del estudio. Muestreo proporcional al tamaño de la población (PPT): Método en el que la probabilidad de selección de una determinada unidad de muestreo es proporcional a su tamaño (generalmente el número de individuos u hogares que contiene la unidad de muestreo). En estas situaciones, si se utilizara el muestreo aleatorio para seleccionar las unidades de muestreo, los individuos de las mayores unidades de muestreo tendrían una probabilidad mucho menor de ser seleccionados que los de las unidades de muestreo más pequeñas Ejemplo: Elegir primero hospitales y después de haberlos seleccionado, realizamos el muestreo de pacientes dentro de cada hospital. 1.5 Diferentes formas de hacer muestreo La encuesta es una técnica de recolección de datos que consta de una serie de preguntas estandarizadas hechas a una muestra representativa de la población de la que buscamos obtener información. Es una técnica útil para cualquiera que busque recopilar datos. Asociado con cada elemento de la población existe una o más variables de interés. Una encuesta permite conseguir información sobre características poblacionales desconocidas llamadas parámetros. 1.5.1 Tipos de encuestas según la forma de aplicación Encuesta por correo: Consiste en enviar un cuestionario a través del servicio postal para que después de ser respondido, sea regresado al remitente. Encuesta por vía telefónica: Consiste en realizar el cuestionario a través de una llamada telefónica, en la que el encuestador debe ir capturando las respuestas del encuestado. Encuesta personal: Consiste en realizar el cuestionario cara a cara, debe existir una interacción entre encuestador y encuestado, normalmente el encuestador toma nota de las respuestas aunque en ocasiones solo entrega el cuestionario y es el encuestado quien lo llena. Una encuesta personal puede ser de dos tipos: De intercepción: el investigador suele ubicarse en espacios públicos como centros comerciales o parques para hacer una entrevista con preguntas concisas a personas que integran su muestra de estudio. De puerta en puerta: En este tipo de encuestas, el investigador recorre casa por casa y solicita al participante tiempo para poder hacer aplicar el cuestionario. Encuesta online: Consiste en realizar el cuestionario utilizando el internet como medio de distribución, las encuestas online se caracterizan principalmente por ser económicas. 1.5.2 Tipos de encuestas según sus objetivos Encuestas descriptivas: estas encuestas buscan crear un registro sobre las actitudes o condiciones presentes dentro de una población en un momento determinado, es decir, en el momento en el que se realiza la encuesta. Encuestas análiticas: a diferencia de las descriptivas, su objetivo no es documentar un problema sino explicar y describirlo para poder encontrar la mejor solución. 1.5.3 Tipos de encuestas según las preguntas Respuesta abierta: estas permiten al encuestado tener la libertad de responder libremente cada pregunta, esto permite obtener respuestas más profundas y también obtener respuestas en las que no se había pensado, sin embargo, el problema de este tipo de encuestas es que es muy difícil de cuantificar, debido a que se deben interpretar las respuestas. Respuesta cerrada: en este tipo, los encuestados deberán elegir alguna de las posibles opciones, su principal ventaja es que son más fáciles de cuantificar, sin embargo, en ocasiones ninguna de las opciones refleja el pensamiento de los participantes, para ello, siempre es recomendable añadir la opción \"otro\". Respuesta continua: este tipo de respuestas toman un número incontable de valores, por ejemplo: Edad Salario Número de personas que habitan en la casa 1.5.4 Ciclo de vida de una encuesta El investigador debe transitar los siguientes pasos: Búsqueda de constructores: los constructores son las ideas abstractas acerca de las cuales el investigador desea inferir. En una encuesta de calidad de vida, se desea saber cuántas personas pobres hay en una determinada región, por lo que, es necesario decidir acerca de ¿qué es pobreza?, etc. Medición: la cuestión clave para realizar una buena medición es diseñar preguntas que produzcan respuestas que reflejen perfectamente los constructores que se intentan medir. Por ejemplo, en la encuesta de calidad de vida, un indicador de pobreza puede estar dado en términos del número de electrodomésticos que posee el hogar. Así, es posible preguntar lo siguiente: ¿cuántos televisores tiene en su hogar? o también ¿cántas bombillas eléctricas tiene su hogar? Respuesta: En algunas ocasiones la respuesta puede ser parte de la pregunta, siendo la tarea del respondiente escoger entre las categorías preguntadas, en otras ocasiones, el respondiente genera una respuesta concreta en sus propias palabras. Edición: Este proceso intenta detectar datos atípicos y revisar la información para obtener la mejor medida del constructor buscado, es decir, deben existir relaciones lógicas entre las preguntas de una encuesta. Por ejemplo, si el respondiente declara tener 12 años de edad y haber dado a luz a 5 hijos, debe existir un proceso de edición para este individuo. Análisis y entrega de resultados: el proceso estadístico arroja estimaciones que permiten la toma de decisiones y la resolución de los objetivos propuestos al comienzo de la investigación. 1.6 Tamaño de muestra Es imprescindible en una buena estimación conocer el tamaño de muestra adecuado que permitirá controlar o cuantificar el error de muestreo. Se presenta a continuación la fórmula estadística que permite conocer el tamaño de muestra necesario para lograr con 95% de confianza (\\(\\alpha\\)) un error de muestreo (e). \\[ m=\\frac{p(1-p)Z_{1-\\alpha/2}^2}{e²}; \\] \\[n=\\frac{m}{1+\\frac{m}{N}}\\] Donde: N = Es el tamaño de población. n = Tamaño de muestra. p = Proporción esperada (50% por default). \\(Z_{1-\\alpha/2}\\) = Percentil \\(\\alpha/2\\) de la distribución Normal estándar. En la medida en que se desea disminuir el error de muestreo, es necesario incrementar de manera exponencial el tamaño de muestra. Se presenta a continuación una gráfica que permite conocer el tamaño de muestra de acuerdo con el error de muestreo a tolerar. n_muestra &lt;- function(e = 0.04, p = 0.5, alpha = 0.95, N = 100000){ m = p*(1-p)*(qnorm(1- (1-alpha)/2)/e)^2 n = ceiling(m/(1 + m/N)) return(n) } Ejemplo Suponiendo un tamaño poblacional de 3 millones de personas, y con 95% de confianza un error máximo a tolerar de 2%, el tamaño de muestra necesario para estimar una proporción es: n_muestra(e = 0.02, p = 0.5, alpha = 0.95, N = 3000000) ## [1] 2399 En este ejemplo, por practicidad se redondea el tamaño de la muestra a 2400 unidades. Veamos ahora una gráfica que permita anañizar la relación existente entre el tamaño de muestra y el error de muestreo. library(dplyr) library(ggplot2) tam_muestra &lt;- tibble(error = seq(0.02, 0.1, by = 0.001)) tam_muestra %&gt;% mutate(n = n_muestra(e = error)) %&gt;% ggplot(aes(x = error, y = n)) + geom_line() + geom_point() + ggtitle(&quot;Relación entre error de muestreo y tamaño de muestra&quot;) + xlab(&quot;Error de muestreo&quot;) + ylab(&quot;Tamaño de muestra&quot;) Ahora analizaremos la relación existente entre el tamaño de muestra y el tamaño poblacional cuando fijamos el error de muestreo en 3.5%. tam_muestra &lt;- tibble(N = seq(1000, 100000, by = 1000)) tam_muestra %&gt;% mutate(n = n_muestra(e = 0.035, N = N)) %&gt;% ggplot(aes(x = N, y = n)) + geom_line() + geom_point() + ggtitle(&quot;Relación entre tamaño de población y tamaño de muestra&quot;) + xlab(&quot;Tamaño de población&quot;) + ylab(&quot;Tamaño de muestra&quot;) Se puede apreciar que a mayor tamaño de población es necesario una muestra más grande, sin embargo, no es un comportamiento lineal. Debido a que una de las condiciones de muestreo es que la selección es aleatoria, existe un punto de saturación de información, en donde no se necesita aumentar más el tamaño de muestra (aunque el tamaño de la población siga creciendo) "],["programación-estadística-en-r.html", "Capítulo 2 Programación estadística en R 2.1 Carga de librerías y datos 2.2 Marco de muestreo 2.3 Métodos de muestreo 2.4 Muestreo estratificado", " Capítulo 2 Programación estadística en R 2.1 Carga de librerías y datos El primer paso para realizar una muestra en R es cargar las librerías necesarias de trabajo y el/los conjuntos de datos que servirán como marco de muestreo. Librerías library(foreign) library(tidyverse) library(dplyr) library(tidyr) library(naniar) library(sampling) library(stringr) Carga de datos mzn_viv &lt;- read.dbf(&quot;data/cpv2010_manzanas_viviendas.dbf&quot;) head(mzn_viv) ## CVEGEO VIV0 VIV1 VIV2 VIV2_R VIV3 VIV3_R VIV4_R VIV5_R VIV6 VIV6_R ## 1 0900200010010001 48 48 47 97.9 199 98.5 4.2 0.9 0 0 ## 2 0900200010010002 45 44 41 93.2 149 94.3 3.6 0.9 -6 -6 ## 3 0900200010010003 33 32 30 93.8 130 95.6 4.3 0.9 0 0 ## 4 0900200010010004 42 42 40 95.2 161 96.4 4.0 0.9 0 0 ## 5 0900200010010005 43 41 38 92.7 142 94.0 3.7 0.8 0 0 ## 6 0900200010010006 42 39 39 100.0 156 100.0 4.0 0.8 0 0 ## VIV7 VIV7_R VIV8 VIV8_R VIV9 VIV9_R VIV10 VIV10_R VIV11 VIV11_R VIV12 VIV12_R ## 1 5 10.6 41 87.2 -6 -6.0 0 0 -6 -6 44 93.6 ## 2 -6 -6.0 39 95.1 4 9.8 0 0 -6 -6 39 95.1 ## 3 3 10.0 27 90.0 4 13.3 0 0 0 0 30 100.0 ## 4 4 10.0 36 90.0 -6 -6.0 0 0 4 10 36 90.0 ## 5 5 13.2 33 86.8 -6 -6.0 0 0 -6 -6 36 94.7 ## 6 -6 -6.0 38 97.4 -6 -6.0 0 0 -6 -6 37 94.9 ## VIV13 VIV13_R VIV14 VIV14_R VIV15 VIV15_R VIV16 VIV16_R VIV17 VIV17_R VIV18 ## 1 0 0 46 97.9 0 0 46 97.9 0 0 196 ## 2 0 0 40 97.6 0 0 40 97.6 0 0 148 ## 3 0 0 30 100.0 0 0 30 100.0 0 0 130 ## 4 0 0 40 100.0 0 0 40 100.0 0 0 161 ## 5 0 0 38 100.0 0 0 38 100.0 0 0 142 ## 6 0 0 39 100.0 0 0 39 100.0 0 0 156 ## VIV18_R VIV19 VIV19_R VIV20 VIV20_R VIV21 VIV21_R VIV22 VIV22_R VIV23 VIV23_R ## 1 98.5 46 97.9 0 0 196 98.5 46 97.9 0 0 ## 2 99.3 40 97.6 0 0 148 99.3 40 97.6 0 0 ## 3 100.0 30 100.0 0 0 126 96.9 30 100.0 0 0 ## 4 100.0 40 100.0 0 0 161 100.0 40 100.0 0 0 ## 5 100.0 38 100.0 0 0 142 100.0 38 100.0 0 0 ## 6 100.0 39 100.0 0 0 156 100.0 39 100.0 0 0 ## VIV24 VIV24_R VIV25 VIV25_R VIV26 VIV26_R VIV27 VIV27_R VIV28 VIV28_R VIV29 ## 1 46 97.9 0 0 46 97.9 45 95.7 28 59.6 0 ## 2 40 97.6 0 0 40 97.6 39 95.1 19 46.3 0 ## 3 30 100.0 0 0 30 100.0 28 93.3 12 40.0 0 ## 4 40 100.0 0 0 39 97.5 34 85.0 22 55.0 -6 ## 5 38 100.0 0 0 38 100.0 38 100.0 24 63.2 0 ## 6 39 100.0 0 0 39 100.0 36 92.3 27 69.2 0 ## VIV29_R VIV30 VIV30_R VIV31 VIV31_R VIV32 VIV32_R VIV33 VIV33_R VIV34 VIV34_R ## 1 0 0 0 43 91.5 46 97.9 21 44.7 45 95.7 ## 2 0 0 0 37 90.2 40 97.6 25 61.0 37 90.2 ## 3 0 0 0 28 93.3 30 100.0 15 50.0 29 96.7 ## 4 -6 -6 -6 39 97.5 40 100.0 22 55.0 38 95.0 ## 5 0 0 0 38 100.0 38 100.0 20 52.6 37 97.4 ## 6 0 0 0 38 97.4 39 100.0 20 51.3 36 92.3 ## VIV35 VIV35_R VIV36 VIV36_R VIV37 VIV37_R VIV38 VIV38_R VIV39 VIV39_R VIV40 ## 1 26 55.3 15 31.9 0 0 0 0 25 53.2 0 ## 2 31 75.6 21 51.2 0 0 -6 -6 15 36.6 0 ## 3 22 73.3 12 40.0 0 0 0 0 15 50.0 0 ## 4 33 82.5 18 45.0 0 0 0 0 18 45.0 0 ## 5 32 84.2 15 39.5 0 0 0 0 18 47.4 0 ## 6 31 79.5 15 38.5 0 0 0 0 19 48.7 0 ## VIV40_R VIV41 VIV41_R ## 1 0 0 0 ## 2 0 0 0 ## 3 0 0 0 ## 4 0 0 0 ## 5 0 0 0 ## 6 0 0 0 mzn_pob &lt;- read.dbf(&quot;data/manzanas.dbf&quot;) head(mzn_pob) ## CVEGEO POB1 POB2 POB2_R POB3 POB3_R POB4 POB4_R POB5 POB5_R POB6 ## 1 0900200010542046 1 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 2 0900200010542047 0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 3 0900200010542048 17 0 0.0 -6 -6.0 -6 -6.0 0 0.0 0 ## 4 0900200010542050 4 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 5 0900200010542049 0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 6 0900200010330001 435 15 3.4 19 4.4 10 2.3 29 6.7 39 ## POB6_R POB7 POB7_R POB8 POB8_R POB9 POB9_R POB10 POB10_R POB11 POB11_R POB12 ## 1 -6 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 2 -8 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 3 0 0 0.0 -6 -6.0 0 0.0 6 35.3 7 41.2 15 ## 4 -6 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 5 -8 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 6 9 16 3.7 70 16.1 22 5.1 80 18.4 118 27.1 325 ## POB12_R POB13 POB13_R POB14 POB14_R POB15 POB15_R POB16 POB16_R POB17 POB17_R ## 1 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 2 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 3 88.2 6 35.3 4 23.5 4 23.5 0 0.0 17 100.0 ## 4 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 5 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 6 74.7 58 13.3 135 31.0 50 11.5 22 5.1 417 95.9 ## POB18 POB18_R POB19 POB19_R POB20 POB20_R POB21 POB21_R POB22 POB22_R POB23 ## 1 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 2 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 3 16 94.1 15 88.2 15 88.2 15 88.2 9 52.9 0 ## 4 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 5 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 6 413 94.9 378 86.9 362 83.2 340 78.2 282 64.8 59 ## POB23_R POB24 POB24_R POB25 POB25_R POB26_R POB27_R POB28_R POB29_R POB30_R ## 1 -6.0 -6 -6.0 -6 -6.0 -6.0 -6.0 -6.0 -6.0 -6 ## 2 -8.0 0 -8.0 0 -8.0 -8.0 -8.0 -8.0 -8.0 -8 ## 3 0.0 0 0.0 0 0.0 142.9 13.3 13.3 0.0 27 ## 4 -6.0 -6 -6.0 -6 -6.0 -6.0 -6.0 -6.0 -6.0 -6 ## 5 -8.0 0 -8.0 0 -8.0 -8.0 -8.0 -8.0 -8.0 -8 ## 6 13.6 37 8.5 22 5.1 88.3 32.9 21.5 11.4 33 ## POB31 POB31_R POB32 POB32_R POB33 POB33_R POB34 POB34_R POB35 POB35_R POB36 ## 1 -6 -6.0 -6 -6 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 2 0 -8.0 0 -8 0 -8.0 0 -8.0 0 -8.0 0 ## 3 7 41.2 0 0 -6 -6.0 -6 -6.0 0 0.0 0 ## 4 -6 -6.0 -6 -6 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 5 0 -8.0 0 -8 0 -8.0 0 -8.0 0 -8.0 0 ## 6 231 53.1 7 3 8 3.5 3 1.3 16 6.9 20 ## POB36_R POB37 POB37_R POB38 POB38_R POB39 POB39_R POB40 POB40_R POB41 POB41_R ## 1 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 2 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 3 0.0 0 0.0 -6 -6.0 0 0.0 3 42.9 3 42.9 ## 4 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 5 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 6 8.7 8 3.5 34 14.7 15 6.5 40 17.3 57 24.7 ## POB42 POB42_R POB43 POB43_R POB44 POB44_R POB45 POB45_R POB46 POB46_R POB47 ## 1 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 2 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 3 5 71.4 6 85.7 3 42.9 -6 -6.0 -6 -6.0 0 ## 4 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 5 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 6 132 57.1 172 74.5 25 10.8 75 32.5 31 13.4 9 ## POB47_R POB48 POB48_R POB49 POB49_R POB50 POB50_R POB51 POB51_R POB52 POB52_R ## 1 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 2 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 3 0.0 7 100.0 6 85.7 6 85.7 6 85.7 6 85.7 ## 4 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 5 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 6 3.9 222 96.1 221 95.7 203 87.9 195 84.4 180 77.9 ## POB53 POB53_R POB54 POB54_R POB55 POB55_R POB56 POB56_R POB57 POB57_R POB58 ## 1 -6 -6.0 -6 -6.0 -6 -6 -6 -6.0 -6 -6.0 -6 ## 2 0 -8.0 0 -8.0 0 -8 0 -8.0 0 -8.0 0 ## 3 3 42.9 0 0.0 0 0 0 0.0 10 58.8 0 ## 4 -6 -6.0 -6 -6.0 -6 -6 -6 -6.0 -6 -6.0 -6 ## 5 0 -8.0 0 -8.0 0 -8 0 -8.0 0 -8.0 0 ## 6 155 67.1 32 13.9 23 10 16 6.9 204 46.9 8 ## POB58_R POB59 POB59_R POB60 POB60_R POB61 POB61_R POB62 POB62_R POB63 POB63_R ## 1 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 2 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 3 0.0 0 0.0 -6 -6.0 0 0.0 0 0.0 0 0.0 ## 4 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 5 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 6 3.9 11 5.4 7 3.4 13 6.4 19 9.3 8 3.9 ## POB64 POB64_R POB65 POB65_R POB66 POB66_R POB67 POB67_R POB68 POB68_R POB69 ## 1 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6 -6 ## 2 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8 0 ## 3 -6 -6.0 0 0.0 3 30.0 4 40.0 9 90 3 ## 4 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6 -6 ## 5 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8 0 ## 6 36 17.6 7 3.4 40 19.6 61 29.9 153 75 33 ## POB69_R POB70 POB70_R POB71 POB71_R POB72 POB72_R POB73 POB73_R POB74 POB74_R ## 1 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 2 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 3 30.0 -6 -6.0 3 30.0 0 0.0 10 100.0 10 100.0 ## 4 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 ## 5 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 ## 6 16.2 60 29.4 19 9.3 13 6.4 195 95.6 192 94.1 ## POB75 POB75_R POB76 POB76_R POB77 POB77_R POB78 POB78_R POB79 POB79_R POB80 ## 1 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 2 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 3 9 90.0 9 90.0 9 90.0 6 60.0 0 0.0 0 ## 4 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 -6.0 -6 ## 5 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 -8.0 0 ## 6 175 85.8 167 81.9 160 78.4 127 62.3 27 13.2 14 ## POB80_R POB81 POB81_R OID ## 1 -6.0 -6 -6.0 1 ## 2 -8.0 0 -8.0 2 ## 3 0.0 0 0.0 3 ## 4 -6.0 -6 -6.0 4 ## 5 -8.0 0 -8.0 5 ## 6 6.9 6 2.9 6 2.2 Marco de muestreo El marco de muestreo es el conjunto de datos que contiene a todos los elementos elegiblres en la muestra de acuerdo con la población objetiva definida por el investigador. Creación de marco de muestreo marco &lt;- mzn_viv %&gt;% as_tibble() %&gt;% dplyr::select(CVEGEO, VIV2) %&gt;% dplyr::left_join(mzn_pob, by = &quot;CVEGEO&quot;) %&gt;% dplyr::mutate(ID_unit = 1:nrow(mzn_viv)) %&gt;% dplyr::select(ID_unit, CVEGEO, VIV2, POB21, POB52, POB77) %&gt;% naniar::replace_with_na_if(.predicate = is.numeric, condition = ~.x &lt; 0) head(marco) ## # A tibble: 6 × 6 ## ID_unit CVEGEO VIV2 POB21 POB52 POB77 ## &lt;int&gt; &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; ## 1 1 0900200010010001 47 157 81 76 ## 2 2 0900200010010002 41 115 66 49 ## 3 3 0900200010010003 30 103 58 45 ## 4 4 0900200010010004 40 132 70 62 ## 5 5 0900200010010005 38 121 64 57 ## 6 6 0900200010010006 39 132 79 53 2.3 Métodos de muestreo Existen diferentes formas de realizar una muestra. Algunas de las más simples se presentan a continuación: Muestreo aleatorio simple con reemplazo Muestreo aleatorio simple sin reemplazo Muestreo aleatorio sistemático Muestreo estratificado con afijación simple Muestreo estratificado con afijación proporcional 2.3.1 Muestreo aleatorio simple sin/con remplazo Métodos de muestreo # srswor MAS sin remplazo # srswr MAS con remplazo # systematic proporcional al tama?o set.seed(310308261) muestra &lt;- sampling::strata( marco, stratanames = NULL, size = 20, method = &quot;srswor&quot;, description = TRUE ) ## ## Population total and number of selected units: 63239 20 # factor de expansion muestra_ponde &lt;- getdata(marco, muestra) %&gt;% mutate(fe_mzn = 1/Prob) head(muestra_ponde) ## CVEGEO VIV2 POB21 POB52 POB77 ID_unit Prob fe_mzn ## 1 0900200010487009 44 125 64 61 1152 0.0003162605 3161.95 ## 2 0900200010932006 10 28 13 15 2289 0.0003162605 3161.95 ## 3 0900300010978011 68 195 94 101 5298 0.0003162605 3161.95 ## 4 0900300011590030 19 45 24 21 7126 0.0003162605 3161.95 ## 5 0900500010296028 0 0 0 0 9384 0.0003162605 3161.95 ## 6 0900500010402001 83 208 107 101 9713 0.0003162605 3161.95 Estimación del numero de viviendas con base en una muestra de 20 manzanas muestra_ponde %&gt;% summarise( Total = sum(fe_mzn), pob_total = sum(fe_mzn*POB21), viviendas = sum(fe_mzn * VIV2) ) ## Total pob_total viviendas ## 1 63239 6839298 2687658 # valores reales marco %&gt;% summarise( viviendas = sum(VIV2), pob_total = sum(POB21, na.rm = TRUE) ) ## # A tibble: 1 × 2 ## viviendas pob_total ## &lt;int&gt; &lt;int&gt; ## 1 2378763 6212042 #error relativo viviendas dif = (2378763 - 2260794) / 2378763 dif ## [1] 0.04959258 #error relativo poblacion dif2 = (6640095 - 6634328) / 6640095 dif2 ## [1] 0.0008685117 2.3.2 Muestreo con probabilidades desiguales # &quot;systematic&quot; probabilidades desiguales muestra2 &lt;- sampling::strata( marco, stratanames = NULL, size = 20, method = &quot;systematic&quot;, pik = marco$VIV2, description = TRUE ) ## Warning in inclusionprobabilities(pik, size): there are zero values in the initial vector a ## ## Population total and number of selected units: 63239 20 muestra_ponde &lt;- marco %&gt;% filter(ID_unit %in% muestra2$ID_unit) %&gt;% left_join(muestra2, by = &quot;ID_unit&quot;) %&gt;% mutate(fe_mzn = 1/Prob) #fe_mzn: factor de expansion 2.4 Muestreo estratificado # Variable de estratificación: por alcaldía marco_estratificado &lt;- marco %&gt;% mutate(alcaldia = str_sub(CVEGEO,3,5) ) diccionario_estratos &lt;- marco_estratificado %&gt;% dplyr::select(alcaldia) %&gt;% distinct() %&gt;% mutate(id_estrato = row_number()) marco_estratificado &lt;- marco_estratificado %&gt;% left_join(diccionario_estratos, by = &quot;alcaldia&quot;) %&gt;% arrange(id_estrato) 2.4.1 Muestreo estratificado con afijación simple # Estratificado PPT (probabilidad proporcional al tamaño) con afijación simple (mismo tamaño de muestra) muestra_estratificada &lt;- sampling::strata( marco_estratificado, stratanames = &quot;id_estrato&quot;, size = rep(20,16), method = &quot;systematic&quot;, pik = marco_estratificado$VIV2, description = TRUE ) ## Stratum 1 ## ## Population total and number of selected units: 2991 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 2 ## ## Population total and number of selected units: 4715 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 3 ## ## Population total and number of selected units: 1006 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 4 ## ## Population total and number of selected units: 8330 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 5 ## ## Population total and number of selected units: 2780 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 6 ## ## Population total and number of selected units: 14394 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 7 ## ## Population total and number of selected units: 1414 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 8 ## ## Population total and number of selected units: 941 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 9 ## ## Population total and number of selected units: 5244 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 10 ## ## Population total and number of selected units: 3002 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 11 ## ## Population total and number of selected units: 4893 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 12 ## ## Population total and number of selected units: 2738 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 13 ## ## Population total and number of selected units: 2217 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 14 ## ## Population total and number of selected units: 2704 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 15 ## ## Population total and number of selected units: 2533 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 16 ## ## Population total and number of selected units: 3337 20 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Number of strata 16 ## Total number of selected units 320 # Estratificado con afijación proporcional y probabilidad afijacion_proporcional &lt;- marco_estratificado %&gt;% group_by(id_estrato) %&gt;% summarise(viv_total = sum(VIV2), .groups = &quot;drop&quot;) %&gt;% mutate(prop_viv = viv_total/sum(viv_total), n_h = round(prop_viv * 2500, 0) ) muestra_estratificada2 &lt;- sampling::strata( marco_estratificado, stratanames = &quot;id_estrato&quot;, size = afijacion_proporcional %&gt;% pull(n_h), method = &quot;systematic&quot;, pik = marco_estratificado$VIV2, description = TRUE ) ## Stratum 1 ## ## Population total and number of selected units: 2991 120 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 2 ## ## Population total and number of selected units: 4715 183 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 3 ## ## Population total and number of selected units: 1006 48 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 4 ## ## Population total and number of selected units: 8330 332 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 5 ## ## Population total and number of selected units: 2780 107 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 6 ## ## Population total and number of selected units: 14394 477 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 7 ## ## Population total and number of selected units: 1414 66 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 8 ## ## Population total and number of selected units: 941 29 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 9 ## ## Population total and number of selected units: 5244 205 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 10 ## ## Population total and number of selected units: 3002 94 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 11 ## ## Population total and number of selected units: 4893 177 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 12 ## ## Population total and number of selected units: 2738 105 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 13 ## ## Population total and number of selected units: 2217 139 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 14 ## ## Population total and number of selected units: 2704 177 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 15 ## ## Population total and number of selected units: 2533 118 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Stratum 16 ## ## Population total and number of selected units: 3337 125 ## Warning in inclusionprobabilities(pik[y], size[i]): there are zero values in the initial vector a ## Number of strata 16 ## Total number of selected units 2502 muestra_estratificada_prob_ppt &lt;- marco_estratificado %&gt;% filter(ID_unit %in% muestra_estratificada2$ID_unit) %&gt;% left_join(muestra_estratificada2, by = &quot;ID_unit&quot;) %&gt;% mutate(fe_mzn = 1/Prob) muestra_estratificada_prob_ppt ## # A tibble: 2,502 × 12 ## ID_unit CVEGEO VIV2 POB21 POB52 POB77 alcaldia id_estrato.x id_estrato.y ## &lt;int&gt; &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; ## 1 9 090020001… 31 102 50 52 002 1 1 ## 2 43 090020001… 44 129 72 57 002 1 1 ## 3 64 090020001… 11 43 20 23 002 1 1 ## 4 92 090020001… 46 131 64 67 002 1 1 ## 5 128 090020001… 41 111 66 45 002 1 1 ## 6 157 090020001… 39 127 66 61 002 1 1 ## 7 200 090020001… 19 59 33 26 002 1 1 ## 8 215 090020001… 164 422 222 200 002 1 1 ## 9 236 090020001… 11 30 15 15 002 1 1 ## 10 255 090020001… 70 168 96 72 002 1 1 ## # … with 2,492 more rows, and 3 more variables: Prob &lt;dbl&gt;, Stratum &lt;int&gt;, ## # fe_mzn &lt;dbl&gt; "]]
